<!DOCTYPE html>
<html>
  <head>
    <title>Türkiye Last Earthquakes and Effects</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/esri-leaflet@2.0.0/dist/esri-leaflet.js"></script>
    <style>
      body, html {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
      .popup-text {
        font-size: 18px;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      var map = L.map('map').setView([39.0, 35.0], 6);

 var basemapLayer1 = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: 'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
  name: 'OpenStreetMap'
});

var basemapLayer2 = L.tileLayer('https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png', {
  maxZoom: 22,
  attribution: 'Map data © <a href="https://www.thunderforest.com">Thunderforest</a> contributors',
  name: 'Cycle Map'
});

var basemapLayer3 = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
  maxZoom: 17,
  attribution: 'Map data © <a href="https://opentopomap.org">OpenTopoMap</a> contributors',
  name: 'OpenTopoMap'
});

// Create an object that contains all of the layers you want to include in the basemap widget
var baseMaps = {
  "OpenStreetMap": basemapLayer1,
  "OpenTopoMap": basemapLayer3
};

// Add the basemap widget using L.control.layers
L.control.layers(baseMaps).addTo(map);

      var seismicData = L.esri.featureLayer({
        url: 'https://services9.arcgis.com/RHVPKKiFTONKtxq3/arcgis/rest/services/USGS_Seismic_Data_v1/FeatureServer/0',
        where: "mag > 6 AND place LIKE '%Turkey%'",
        onEachFeature: function(feature, layer) {
          layer.bindPopup("<div class='popup-text'><strong>Location:</strong> " + feature.properties.place + "<br>" + "<strong>Magnitude:</strong> " + feature.properties.mag + "<br>" + "<strong>Date:</strong> " + new Date(feature.properties.eventTime) + "<br>" + "<strong>Depth:</strong> " + feature.properties.depth  + " km</div>");
          layer.on('click', function(e) {
            if (buffer) {
              map.removeLayer(buffer);
            }
            var selectedMarker = e.target;
            var latlng = selectedMarker.getLatLng();
            buffer = L.circle(latlng, {
              radius: 100000,
              color: 'red',
              fillOpacity: 0.2
            }).addTo(map);
          });
        },
        style: function(feature) {
          return {
            fillColor: 'red',
            color: 'black',
            weight: 1,
            fillOpacity: 1
          };
        }
      }).addTo(map);

      var buffer;
      map.on('click', function(e) {
        if (buffer) {
          map.removeLayer(buffer);
        }
      });
      L.control.fullscreen().addTo(map);
    </script>
  </body>
</html>
